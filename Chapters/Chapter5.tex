%!TEX root = ../Thesis.tex
%Chapter 5

\chapter{Asymmetric heat transport in ion crystals}
\label{Chapter5}
\lhead{Chapter 5. \emph{Asymmetric heat transport in ion crystals}} % Write in your own chapter title to set the page header

In this chapter I propose to bridge the gap between mathematical models and actual physical systems by exploring the implementation of a thermal rectifier in a realistic, graded system with long-range interactions:
a chain of ultracold ions in a segmented Paul trap with frequency-graded microtraps for each ion. Long-range interactions are due to the Coulomb forces, and the baths at the ends of the chain may be implemented with optical molasses (see fig. \ref{fig:Diagram}). The trapping frequencies of the  microtraps are controlled individually in order to create a graded and asymmetric trap-frequency profile along the chain. This asymmetry will lead to a heat flow that depends on the sign of the temperature difference of the baths. Heat transport in trapped-ion chains has been studied in several works  \cite{Freitas2015,Ruiz2014,Ruiz2019,Pruttivarasin2011,Ramm2014} and interesting phenomena like phase transitions have been investigated \cite{Freitas2015,Ruiz2014,Ruiz2019,Pruttivarasin2011}. The idea of using locally-controlled traps is already mentioned in \cite{Freitas2015} to implement disorder and study its effects. The device I present here may be challenging to implement, but at reach with the current technology, in particular  that of microfabricated traps \cite{Cirac2000,Krauth2014,Schmied2009}. Thus the setting is thought for a small, realistic number of controllable ions.

The chapter is organized as follows. In section \ref{sec:chapter5_PhysicalSystem}, I describe the physical system of trapped ions with graded trap frequencies. I also set the stochastic dynamics due to the action of lasers at the chain edges.
In section \ref{sec:chapter5_HeatFlow}, I implement an efficient  method to find the steady state using Novikov's theorem and solving an algebraic system of equations. In section \ref{sec:chapter5_NumericalResults}, I present simulations of this system exhibiting thermal rectification and discuss the dependence with the number of ions, different options for the ion-laser coupling, and the advantages/disadvantages of using a graded frequency profile instead of a segmented one. Finally, in section \ref{sec:chapter5_Discussion}, I summarize the conclusions, and discuss connections with other works.
%
%
\section{Physical System\label{sec:chapter5_PhysicalSystem}}
%
%
%
%
Consider a linear lattice of $N$ individual harmonic traps of (angular) trapping frequencies  $\omega_n$ evenly distributed along the $x$ axis at a distance $a$ from each other. Each trap contains a single ion that interacts with the rest via Coulomb potentials. All the ions are of the same species, with mass $m$ and charge $q$. The Hamiltonian that describes the dynamics of the system is (I consider only one-dimensional motion along the chain axis)
%
\begin{equation}
    H(\bm{x},\bm{p}) = \sum_{n=1}^N \left[\frac{p_n^2}{2m}  + \frac{m\omega_n^2}{2} (x_n - x_n^{(0)})^2\right] + V_{int}(\bm{x}),
    \label{eq:chapter5_ChainHamiltonian}
\end{equation}
%
where $\{x_n,p_n\}$, position and momentum of each ion, are the components of  the vectors
$\bm{x},\bm{p}$, $x_n^{(0)} = n  a$ are the centers of the harmonic traps, and $V_{int}$ is the sum of the Coulomb interaction potential between all  pairs of ions,
%
\begin{equation}
    V_{int}(\bm{x}) = \frac{1}{2}\sum_n \sum_{l\neq n} V_{C}(\left|x_n-x_l\right|),
    \label{eq:chapter5_InteractionHamiltonian}
\end{equation}
%
with $V_{C}(\left|x_n-x_l\right|) = \frac{q^2}{4\pi\varepsilon_0}\frac{1}{\left|x_n-x_l\right|}$. The ends of the chain are in contact with two thermal reservoirs at temperatures $T_L$ for the left bath and $T_R$ for the right bath respectively. The action of the resevoirs on the dynamics of the chain is modeled via Langevin baths at temperatures $T_L$ and $T_R$ \cite{Lepri2003,Dhar2018}. The equations of motion of the chain, taking into account the baths and the Hamiltonian, are
%
\begin{equation}
    \begin{split}
        \dot{x}_n &= \frac{1}{m}p_n, \\
        \dot{p}_n &= - m\omega_n^2 (x_n-x_n^{(0)}) - \frac{\partial V_{int}}{\partial x_n} - \frac{\gamma_n}{m}p_n + \xi_n(t),
    \end{split}
    \label{eq:chapter5_Dynamics}
\end{equation}
%
where $\gamma_n$ and $\xi_n(t)$ are only non-zero for the ions in the end regions, in contact with the left and right baths in the sets ${\cal L} = \left\{1,2,...,N_L\right\}$ and \linebreak ${\cal R} = \left\{N-(N_R-1),...,N-1,N\right\}$,  see fig. \ref{fig:Diagram}. $\gamma_n$ are friction coefficients and $\xi_n(t)$ are uncorrelated Gaussian noise forces satisfying $\expval{ \xi_n(t)} = 0$ and $\expval{ \xi_n(t)\xi_m(t') } = 2 D_n \delta_{nm}\delta(t-t')$, $D_n$ being the diffusion coefficients. These Gaussian forces are formally the time derivatives of independent Wiener processes (Brownian motions)   $\xi_n(t) = \sqrt{2D_n}\frac{dW_n}{dt}$ \cite{Toral2014,Ruiz2014} and eq. \eqref{eq:chapter5_Dynamics} is a stochastic differential equation (SDE) in the Stratonovich sense \cite{Toral2014}.

\begin{figure}
    \center
    \includegraphics[width=0.75\linewidth]{Figures/Diagram.eps}
    \caption{Schematic representation  of the frequency-graded chain of trapped ions proposed as a thermal rectifier. The left and right ends of the chain are in contact with optical molasses at temperatures $T_L$ and $T_R$ (green and grey boxes respectively). Each ion is in an individual trap. The (angular) frequencies of the traps increase homogeneously from left to right, starting from $\omega_1$ and ending at $\omega_1+\Delta\omega$. The ions interact through the Coulomb force, which is long range, and therefore all the ions interact among them, even distant neighbors. By default  I use 15 ions.}
    \label{fig:Diagram}
\end{figure}

The baths are physically implemented by optical molasses consisting of a pair of counterpropagating Doppler-cooling lasers \cite{Ruiz2014}. The friction and diffusion coefficients for the ions in contact with the baths are given in \cite{Cohen1992,Metcalf2003,Ruiz2014}
%
\begin{equation}
    \begin{split}
        \gamma_n &= -4 \hbar k_{L,R}^2 \left(\frac{I_{L,R}}{I_0}\right)\frac{2\delta_{L,R}/\Gamma}{\left[1 + (2\delta_{L,R}/\Gamma)^2\right]^2},\\
        %
        D_n &= \hbar^2 k_{L,R}^2 \left(\frac{I_{L,R}}{I_0}\right) \frac{\Gamma}{1 + (2\delta_{L,R}/\Gamma)^2},\\
        n &\in \cal{L},\cal{R},
    \end{split}
    \label{eq:chapter5_DopplerCooling}
\end{equation}
%
where $k_L$ ($k_R$) and $I_L$ ($I_R$) are the wave vector and intensity of the left (right) laser. $\delta_L$ ($\delta_R$) is the detuning of the left (right) laser with respect to the angular frequency $\omega_0$ of the atomic transition the laser is exciting, and $\Gamma$ is the corresponding natural line width of the  excited state. The expressions in eq. \eqref{eq:chapter5_DopplerCooling} are valid only if the intensities of the lasers are small compared to the saturation intensity $I_0$, $I_{L,R}/I_0\ll 1$. In this bath model, the friction term in eq. \eqref{eq:chapter5_Dynamics} comes from the cooling action of the laser and the white noise force $\xi_n(t)$ corresponds to the random recoil of the ions due to spontaneous emission of photons \cite{Metcalf2003,Cohen1992}. Using the diffusion-dissipation relation $D = \gamma k_B T $ \cite{Chee2010}, the temperatures of the optical molasses baths are given by
%
\begin{equation}
    T_{L,R} = -\frac{\hbar \Gamma}{4 k_B} \frac{1+(2\delta_{L,R}/\Gamma)^2}{(2\delta_{L,R}/\Gamma)},
    \label{eq:chapter5_Doppler}
\end{equation}
%
with $k_B$ being the Boltzmann constant. If the laser intensities are low enough, the temperatures of the baths are controlled by modifying the detunings. When $\delta = \delta_D=-\Gamma / 2$ the optical molasses reach their minimum possible temperature, the Doppler limit $T_{D} = {\hbar \Gamma}/({2k_B})$. Note that away from the Doppler limit the same temperature may be achieved
for two different values of the detuning. These two possibilities imply different couplings (two different pairs of $\gamma$ and $D$ values) and thus different physical effects that will be studied in section \ref{TC}.
%
%
%
%
\section{Calculation of the stationary heat currents\label{sec:chapter5_HeatFlow}}
%
%
The local energy of each site is defined by
%
\begin{equation}
    H_n = \frac{1}{2m} p_n^2 + \frac{1}{2}m\omega_n^2 \left( x_n - x_n^{(0)}\right)^2 +\frac{1}{2}\sum_{l\neq n} V_C(\left|x_n-x_l\right|).
    \label{eq:chapter5_LocalEnergy}
\end{equation}
%
Differentiating $H_n$ with respect to time I find the continuity  equation
%
\begin{equation}
    \dot{H}_n = \frac{p_n}{m}\! \left[ \xi_n(t)-\gamma_n \frac{p_n}{m} \right]\! - \frac{1}{2m}\!\sum_{l\neq n}\frac{\partial V_C (\left|x_n\!-\!x_l\right|)}{\partial x_n}(p_n + p_l).
    \label{eq:chapter5_continuityFirst}
\end{equation}
%
Two different contributions can be distinguished: $j^B_n \equiv \frac{p_n}{m} \left[ \xi_n(t)-\gamma_n \frac{p_n}{m} \right]$, which is the energy flow from the laser reservoir to the ions at the edges of the chain (only for $n\in {\cal L}, {\cal R}$), and $\dot{H}_n^{int} \equiv - \frac{1}{2m}\sum_{l\neq n}\frac{\partial V_C (\left|x_n-x_l\right|)}{\partial x_n}(p_n + p_l)$, which gives the ``internal'' energy flow due to the interactions with the rest of the ions. In the steady state $\expval{\dot{H}_n} = 0$, and therefore
%
\begin{equation}
    \expval{j^B_n} + \expval{\dot{H}_n^{int}} = 0,
    \label{eq:chapter5_continuitySecond}
\end{equation}
%
where $\langle \cdot\!\cdot\!\cdot \rangle$ stands for the expectation value with respect to  the ensemble of noise processes $\bm\xi (t)$ ($\bm\xi$ represents a vector with
components $\xi_n$). Equation \eqref{eq:chapter5_continuitySecond} implies that, in the steady state, the internal rates $\dot{H}_n^{int}$ vanish for the inner ions of the chain because $j^B_n = 0$ for $n\notin {\cal L},{\cal R}$. In chains with nearest-neighbor (NN) interactions,
$\langle\dot{H}_n^{int}\rangle$ simplifies to two compensating and equal-in-magnitude contributions that define the homogeneous heat flux across the chain.
For long-range interactions this is not so and defining the flux is not so straightforward. A formal possibility is to impose
nearest-neighbor interatomic interactions for some atoms in the chain \cite{Chen2015},
but this approach is not realistic in the current system so I define instead the heat currents
for the left and right baths as
%
\begin{equation}
    \begin{split}
        J_L (t)&= \sum_{n\in {\cal L}} \expval{j^B_n},\\
        J_R (t)&= \sum_{n\in {\cal R}} \expval{j^B_n},
    \end{split}
    \label{eq:chapter5_BathHeatFlows}
\end{equation}
%
respectively. These expressions are in general time-dependent. In the steady state $J_{L,{\rm steady}}$ and $J_{R,{\rm steady}}$ should cancel each other since the local energies stabilize and internal energy flows cancel. I will use either $J_{L,{\rm steady}}$ or $J_{R,{\rm steady}}$ to calculate the total energy flow in the chain, always taking the absolute value, i.e., $J \equiv \abs{J_{L,{\rm steady}}}= \abs{J_{R,{\rm steady}}}$. $J$ is defined as $J_\rightarrow$ when the hot bath is on the left
and $J_\leftarrow$ when it is on the right.

To compute the average heat fluxes of the baths $\expval{j^B_n}$ in eq. \eqref{eq:chapter5_BathHeatFlows} I need
the averages $\expval{p_n(t)\xi_n(t)}$. Instead of explicitly averaging $p_n(t)\xi_n(t)$ over different realizations of the white noise, I use Novikov's theorem \cite{Novikov1965,Ma2011,Toral2014}. Novikov's theorem states that the ensemble average (over  the realizations of the noise) of the product of some functional $\phi(t)$, which depends on a set of
$n_{noise}$ Gaussian noises $\xi_i(t)$ with zero mean value, $\expval{\xi_i(t)} = 0$, and the noise itself, is given by
%
\begin{equation}
    \expval{\xi_i(t)\phi(t)} = \sum_{j=1}^{n_{noise}}\int_0^t dt' \expval{\xi_i(t)\xi_j(t')} \expval{\frac{\delta \phi(t)}{\delta\xi_j(t')}},
    \label{eq:chapter5_Novikov_GeneralExpression}
\end{equation}
%
where ${\delta \phi(t)}/{\delta\xi_j(t')}$ is the functional derivative of $\phi(t)$ with respect to the $j$-th component of the noise. Since the noises are independent from each other and $\delta-$correlated,
%
\begin{equation}
  \begin{split}
    \expval{\xi_i(t)\phi(t)} &= 2D_i \overbrace{\int_0^t dt' \delta(t-t') \expval{\frac{\delta \phi(t)}{\delta\xi_i(t')}}}^{= \frac{1}{2} \lim_{t'\to t^-} \expval{\frac{\delta \phi(t)}{\delta\xi_i(t')}} }\\
    &=D_i \lim_{t'\to t^-} \expval{ \frac{\delta \phi(t)}{\delta\xi_i(t')} }.
  \end{split}
  \label{eq:chapter5_Novikov_WhiteIndependentNoise}
\end{equation}
%
The $1/2$ factor from the integral in eq. \eqref{eq:chapter5_Novikov_WhiteIndependentNoise} comes from the assumption that the Dirac delta function is the limit of even correlation functions when the correlation time goes to 0. The notation $\lim_{t'\to t^-}$ stands for the limit when $t'$ goes to $t$ from below ($t'<t$). To evaluate the functional derivatives of the position $x_n(t)$ and momentum $p_n(t)$ coordinates with respect to the white noises, I integrate eq. \eqref{eq:chapter5_Dynamics} to have its formal solution as a functional depending on the white Gaussian noises $\xi_n(t)$,
%
\begin{equation}
    \begin{split}
        x_n(t) &= x_n(0) +  \frac{1}{m}\int_0^t ds\; p_n(s) ,\\
        p_n(t) &= p_n(0) + \int_0^t ds\; \left[ -\frac{\partial H}{\partial x_n}(s) - \frac{\gamma_n}{m}p_n(s) + \xi_n(s)\right].
    \end{split}
    \label{eq:chapter5_FormalSolution}
\end{equation}
%
Taking the functional derivatives of eq. \eqref{eq:chapter5_FormalSolution} I get for $t'<t$
%
\begin{equation}
  \begin{split}
    \frac{\delta x_n(t)}{\delta \xi_m(t')} &= \frac{1}{m}\int_{t'}^{t} ds\; \frac{\delta p_n(s)}{\delta \xi_m(t')},
    %
    \\
    %
    \frac{\delta p_n(t)}{\delta \xi_m(t')} &= \delta_{nm} -\int_{t'}^{t} ds\;\frac{\delta}{\delta \xi_m(t')}\left[\frac{\partial H}{\partial x_n}(s) + \frac{\gamma_n}{m}p_n(s) \right].
  \end{split}
  \label{eq:chapter5_functional_derivatives}
\end{equation}
%
The integration limits in eq. \eqref{eq:chapter5_functional_derivatives} go from $t'$ to $t$ since the functional derivatives are $0$ when $s<t'$, because the values of the noise in the future cannot affect a signal in the present, which would break causality. I have also used that $\frac{\delta \xi_n(t)}{\delta \xi_m(t')} = \delta_{nm}\delta(t-t')$. Taking the limit $t'\to t^-$ in eq. \eqref{eq:chapter5_FormalSolution} I obtain the values of the functional derivatives of $x_n$ and $p_n$, $ \lim_{t'\to t^-} \delta x_n(t)/\delta \xi_m(t') = 0$ and $\lim_{t'\to t^-} \delta p_n(t)/\delta \xi_m(t') = \delta_{nm}$ ($\delta_{nm}$ is the usual Kronecker delta). Thus I have $\expval{x_n(t) \xi_m(t)} = 0$ and $\expval{p_n(t) \xi_m(t)} = \delta_{nm}D_m$, which gives for the heat flow from the baths
%
\begin{equation}
    \expval{j^B_n} = \frac{1}{m} \left[ D_n-\gamma_n \frac{\expval{p_n^2}}{m} \right].
    \label{eq:chapter5_BathHeatFlowNovikov}
\end{equation}
%
In all simulations I check that $|J_{L,{\rm steady}}|=|J_{R,{\rm steady}}|$ within the numerical tolerance of the computer. To measure the asymmetry of the heat currents I use the rectification factor $R$ defined as
%
\begin{equation}
    R = \frac{ J_\rightarrow - J_\leftarrow}{max(J_\rightarrow,J_\leftarrow)}.
    \label{eq:chapter5_R_Factor}
\end{equation}
%
$R$ may go from $-1$ to $1$ (In the figures I depict it in \% between -100\% and 100\%). If there is no rectification $J_\rightarrow = J_\leftarrow $ and $R=0$. For perfect rectification in the right (left) direction, $J_\rightarrow \gg J_\leftarrow$ ($J_\rightarrow \ll J_\leftarrow$), and $R = 1$ ($R = -1$).
Notice that other  definitions of rectification factors exist in many works
on asymmetric heat transfer so comparisons should be done with care.
%

This model does not show the antithermodynamical behavior  observed in other models
\cite{De-Chiara2018,Levy2014}, and heat is found to flow in all cases from the hot to the
cold bath.
%
%
%
\subsection{Algebraic, small-oscillations approach to calculate the steady state\label{sec:chapter5_steadyState}}
%
%
%
%
To find the temperature profiles and heat currents in the steady state the usual approach is to solve the SDE system in eq. \eqref{eq:chapter5_Dynamics} up to long times  and for many realizations of the white noises $\bm\xi (t)$. In that way, the ensemble averages $\expval{p_n(t \to \infty)^2}$, necessary for both the temperature profiles and heat currents, are computed. This standard route implies a heavy computational effort, in particular  when I want to study the heat transport for several bath configurations, frequency increments and chain parameters. It is possible to circumvent this difficulty and find ensemble averages like $\expval{x_n x_m}$, $\expval{x_n p_m}$, $\expval{p_n p_m}$ (second order moments) without integrating any SDE \cite{Sarkka2019,Rieder1967,Casher1971}. The idea is to impose the condition ${d\expval{\cdot\cdot\cdot}}/{dt} = 0$ for all the second order moments and linearize the dynamical equations of the system around equilibrium.
A system of linear algebraic equations for the moments results, that can be easily solved without solving the SDE many times.
% to solve a system of linear algebraic equations. I will analyze the validity of the linearized approximation in the following section.

\begin{figure}
  \center
  \includegraphics[width=0.75\linewidth]{Figures/24Mg_Temperature_Profiles_And_Evolution.eps}
  \caption{(a) Temperatures of the ions in the stationary state for a graded chain with the parameters described in section \ref{Results_A}. The temperature profiles found with the algebraic method (eq. \eqref{eq:chapter5_SteadyStateEquation}) are indistinguishable from the ones found solving the Langevin equation (eq. \eqref{eq:chapter5_Dynamics}). Empty triangles (squares) correspond to $T_L = T_H$ ($T_L = T_C$) and $T_R = T_C$ ($T_R = T_H$). (b) Heat currents  as a function of time for $T_L = T_H$ and $T_R = T_C$, see eq. (\ref{eq:chapter5_BathHeatFlows}): $J_L(t)$ (solid green line) from the left reservoir into the chain;$J_R(t)$ (dotted grey line) from the right reservoir into the chain (negative except at very short times); $J_L(t)+J_R(t)$ (dotted-dashed black line), which must go to zero in the steady state. The three lines tend to stationary values marked by horizontal lines. Parameters: $\omega_1 = 2\pi \times 50$ kHz, $a=50\, \mu$m,  $\delta_H = -0.02 \, \Gamma$, and $\delta_C = -0.1 \, \Gamma$, which gives temperatures $T_H \approx 12$ mK and $T_C \approx 3$ mK. $\Delta\omega = 0.5 \, \omega_1$. In all figures $\Gamma = 2\pi \times 41.3$ MHz.}
  \label{fig:Temperature_Profiles_Magnesium}
\end{figure}

To linearize the SDE in eq. \eqref{eq:chapter5_Dynamics} I approximate the potential energy of the Hamiltonian in eq. \eqref{eq:chapter5_ChainHamiltonian}, $V(\bm{x}) = V_{int}(\bm{x}) + m\;\sum_n \omega_n^2 (x_n-x_n^{(0)})^2/2$, by its harmonic approximation around the equilibrium positions $\bm{x}^{eq}$, defined by  $\frac{\partial V(\bm{x})}{\partial\bm{x}}\Big|_{\bm{x}=\bm{x}^{eq}} = 0$. The approximate potential (ignoring the zero-point energy) is
%
\begin{equation}
    V(\bm{x})\approx  \frac{1}{2} \sum_{n,m} K_{nm} (x_n-x_n^{eq})(x_m-x_m^{eq}),
\end{equation}
%
with $K_{nm} = \frac{\partial^2 V(\bm{x})}{\partial x_n \partial x_m}\Big|_{\bm{x}=\bm{x}^{eq}}$ being the Hessian matrix entries of $V(\bm{x})$ around the equilibrium configuration \cite{James1998}
%
\begin{equation}
    K_{nm} =
    \begin{cases}
        m \omega_n^2 + 2 \left(\frac{q^2}{4\pi\varepsilon_0}\right) \sum_{l \neq n  }\frac{1}{\left|x_n^{eq}-x_l^{eq}\right|^3} & \text{if  } n=m\\

         - 2 \left(\frac{q^2}{4\pi\varepsilon_0}\right) \frac{1}{\left|x_n^{eq}-x_m^{eq}\right|^3} & \text{if  } n \neq m
    \end{cases}.
\end{equation}
%
Note that this approximation does not modify the two main features of the system, namely asymmetry and long-range interactions, which are manifest in the asymmetric distribution of $\omega_n$ and the non-zero off-diagonal elements of the $K$ matrix, respectively. In the following I will use $y_n=x_n-x_n^{eq}$ to simplify the notation. The linearized dynamics around the equilibrium positions are given by
%
\begin{equation}
    \begin{split}
        \dot{y}_n &= \frac{1}{m}p_n,\\
        \dot{p}_n &= -\sum_{l}K_{nl}y_l- \frac{\gamma_n}{m}p_n + \xi_n(t).
    \end{split}
    \label{eq:chapter5_DynamicsHarmonic}
\end{equation}
%
Now, I set ${d\expval{\cdot\!\cdot\!\cdot}}/{dt} = 0$ for all the moments. Using eq. \eqref{eq:chapter5_DynamicsHarmonic} and applying Novikov's theorem I find

%
\begin{equation}
    \begin{split}
        \expval{p_n p_l} - \gamma_l\expval{y_n p_l} - \sum_m K_{lm}\expval{y_n y_m} &= 0,\\
        \sum_{m}\left[ K_{nm}\expval{y_m p_l} + K_{lm}\expval{y_m p_n} \right] + \frac{1}{m}\left( \gamma_l + \gamma_n \right)\expval{p_n p_l} &= 2 \delta_{nl} D_n.
    \end{split}
    \label{eq:chapter5_SteadyStateEquation}
\end{equation}
%
The system \eqref{eq:chapter5_SteadyStateEquation} is linear in the second order moments so it can be solved numerically to find the steady-state values of the moments. Besides eq. \eqref{eq:chapter5_SteadyStateEquation} I have that $\expval{y_n p_l} = - \expval{y_l p_n}$, which follows from eq. \eqref{eq:chapter5_DynamicsHarmonic} and $d\expval{y_n y_m}/dt = 0$. Since there are $\frac{1}{2}N(N-1)$ independent $\expval{y_n p_l}$ moments, I choose the ones with $n<l$. Similarly, the moments $\expval{y_n y_l}$ and $\expval{p_n p_l}$ contribute with $\frac{1}{2}N(N+1)$ independent variables each and I choose the ones with $n\leq m$. Thus there are in total $\frac{1}{2}N(3N+1)$ independent moments that can be arranged in the vector
%
\begin{equation}
\begin{split}
    \bm\eta = \Big[ &\expval{y_1 y_1},\expval{y_1 y_2},...,\expval{y_N y_N},\\
    &\expval{p_1 p_1},\expval{p_1 p_2},...,\expval{p_N p_N},\\
    &\expval{y_1 p_2},\expval{y_1 p_3},...,\expval{y_{N-1} p_N}\Big]^T.
    \label{eq:chapter5_CovariancesVector}
\end{split}
\end{equation}
%
There are the same number of independent equations
%in eq. \eqref{eq:chapter5_SteadyStateEquation}
as independent moments: $N^2$
equations correspond to the first line in eq.  \eqref{eq:chapter5_SteadyStateEquation}, and $\frac{1}{2}N(N+1)$ equations
to the second line because of the symmetry with respect to $n,l$. The system of equations \eqref{eq:chapter5_SteadyStateEquation} may be compactly written as $\mathbf{A}\boldsymbol\eta = \mathbf{B}$, where $\mathbf{A}$ and $\mathbf{B}$ are a $\frac{1}{2}N(3N+1)$ square matrix and vector.

\section{Numerical Results\label{sec:chapter5_NumericalResults}}


I now display the results of the simulations. To find the temperature profiles and the currents in the steady state I use the algebraic method described in section \ref{sec:chapter5_steadyState}. I also check that the results coincide with those by solving eq. \eqref{eq:chapter5_Dynamics} for many different realizations of the noise forces $\bm\xi (t)$ and averaging. The code for all the numerical simulations has been written in the language \textit{Julia} \cite{Bezanson2012,Bezanson2017}. In particular, to solve the Langevin equation, I used \textit{Julia}'s package \textit{DifferentialEquations.jl} \cite{Rackauckas2017}.

To model the baths and the chain I use atomic data taken from ion trap experiments \cite{Leupold2015,Lo2015}. I consider 15 $^{24}$Mg$^+$ ions in all figures except in fig. \ref{fig:N_Dependence}. Only the three leftmost and three rightmost ions interact with Doppler cooling lasers. The Doppler cooling lasers excite the transition $3s^2S_{1/2}\rightarrow 3p^2P_{1/2}$, with angular frequency $\omega_0 = 2 \pi \times 1069$ THz and excited state line width $\Gamma = 2\pi \times 41.3$ MHz \cite{Ruiz2014}. For this ionic species and atomic transition the Doppler limit is $T_D = 1$ mK.
%I use typical trap frequencies of the order of MegaHertzs and intertrap spacings of a few tens of $\mu$m.
The intensities of the laser beams are small compared to the saturation intensity $I_0$ so that eq. \eqref{eq:chapter5_DopplerCooling} holds. I take $I_n/I_0 = 0.08$ for the ions  in the laser beams, whereas  $I_n=0$ for the rest.

The temperatures $T_L,\,T_R$ of the left and right laser baths are controlled with their detunings $\delta_L,\,\delta_R$ with respect to the atomic transition. I fix two values for the detunings, $\delta_H$ and $\delta_C$, such that $T_H>T_C$ (hot and cold baths, also source and drain) and I define $J_\rightarrow$ ($J_\leftarrow$) as the stationary heat current in the chain when $T_L = T_H$ and $T_R = T_C$ ($T_L = T_C$ and $T_R = T_H$).

Except in section \ref{GS} I consider a graded frequency profile.
%In the graded chain the frequency increases by $\frac{\Delta\omega}{N-1}$ from one trap to the next.
If the frequency of the leftmost trap is $\omega_1$, the frequency of the $n$th trap will be $\omega_n = \omega_1 +\Delta\omega\frac{n-1}{N-1}$ up to $\omega_1 +\Delta\omega$ for the rightmost trap. In
section \ref{GS}, I compare the graded chain to a segmented chain, where the left half of the chain has trapping frequencies $\omega_1$ while the other half has $\omega_1 +\Delta\omega$.


\subsection{Evolution to steady state \label{Results_A}}

\begin{figure}
  \center
  \includegraphics[width=0.75\linewidth]{Figures/Graded_24Mg_FluxAndRectification_VS_FreqGradient.eps}
  \caption{Graded chain of $N=15$ $^{24}$Mg$^+$ ions. (a) Stationary fluxes for different frequency increments: $J_\rightarrow$   (for $T_L = T_H$ and $T_R = T_C$, dashed line); $J_\leftarrow$ (for $T_L = T_C$ and $T_R = T_H$, solid line) (b) Rectification factor. Parameters: $\omega_1 = 2 \pi \times 1$ MHz, $l = 5.25\;\mu$m, $a = 4.76\, l$ ($25\,\mu$m), $\delta_H = -0.02 \,\Gamma$, and $\delta_C = -0.1 \, \Gamma$.}
  \label{fig:RFG}
\end{figure}

To compare the results by solving eq. \eqref{eq:chapter5_Dynamics} and averaging and those from the algebraic method, I simulated a frequency graded chain with a trapping frequency $\omega_1 = 2\pi \times 50$ kHz for the leftmost ion, see fig. \ref{fig:Temperature_Profiles_Magnesium}.  The number of ions interacting with the laser beams (three on each bath) is consistent with the lattice constant and typical waists of Gaussian laser beams \cite{Leupold2015,Lo2015}. To set the trap distance I fix first the characteristic length  $l =  \left(\frac{q^2}{4\pi\varepsilon_0}\frac{1}{m\omega_1^2}\right)^{1/3}$ as the distance for which the Coulomb repulsion of two ions equals the trap  potential energy for an ion at a distance
$l$ away from the center of its trap.
If $a<l$, the Coulomb repulsion of the ions is stronger than the trap confinement which makes the ions jump from their traps. With the parameters used in this section I have $l = 38.7\,\mu$m and set $a = 1.29 \,l=50\,\mu$m. The detunings of the \textit{hot} and \textit{cold} lasers are $\delta_H = -0.02 \, \Gamma$, and $\delta_C = -0.1 \, \Gamma$ which gives temperatures $T_H \approx 12$ mK and $T_C \approx 3$ mK. I fix the value $\Delta\omega = 0.5 \, \omega_1$ for the frequency increment.

The results of the two methods are in very good agreement. In the scale of fig. \ref{fig:Temperature_Profiles_Magnesium} (a)
the calculated local temperatures are undistinguishable. In the calculation based on solving the dynamics I had to integrate eq. \eqref{eq:chapter5_Dynamics} for $N_{trials} = 1000$ realizations of white noise $\bm{\xi}(t)$. The method based on the system of moments
shortened the calculation time with respect to the dynamical trajectories   by a factor of $1/700$. In fact, the time gain is even more important because
the dynamical method requires further processing, performing a time averaging to compute the stationary flux in addition to noise averaging, see fig.  \ref{fig:Temperature_Profiles_Magnesium} (b).


Additionally, the relaxation to the steady state slows down when the frequencies of the traps increase since the deterministic part of the Langevin equation dominates the dynamics over the stochastic part, entering an under-damped regime. In contrast, this increase does not affect the
algebraic method.
%%%%%%%%%%%%%%%%%%%%
\begin{figure}
  \center
  \includegraphics[width=0.75\linewidth]{Figures/Graded_24Mg_Rectification_VS_Gradient_and_lattConstant.eps}
  \caption{ Rectification factor in a graded chain of $N=15$ $^{24}$Mg$^+$ ions for different trap distances and frequency increment. The dashed lines are for $R = 0$ and delimit the regions $J_\rightarrow > J_\leftarrow$ and $J_\rightarrow < J_\leftarrow$. The parameters  are $\omega_1 = 2 \pi \times 1$ MHz, $l = 5.25\,\mu$m, $\delta_H = -0.02 \,\Gamma$, and $\delta_C = -0.1 \, \Gamma$.}
  \label{fig:Graded_24Mg_Rectification_VS_Gradient_and_lattConstant}
\end{figure}
%
%
%
%
\subsection{Rectification in frequency graded chains \label{GradedChains}}
%
%
\begin{figure}
  \center
  \includegraphics[width=0.75\linewidth]{Figures/R_as_function_of_TemperatureBias.eps}
  \caption{ (a) Friction coefficient defined in eq. \eqref{eq:chapter5_DopplerCooling}. (b) Bath temperature defined in eq. \eqref{eq:chapter5_Doppler}. (c) Rectification as a function of the temperature difference between the hot and cold baths $T_H -T_C$ for $\delta_H$ below (dashed black line) and above (solid blue line) the Doppler limit, and $\delta_C=\delta_D$ (Doppler limit). Parameters: $\omega_1 = 2 \pi \times 1$ MHz, $\Delta \omega = 0.15 \, \omega_1$, $l = 5.25\,\mu$m, $a = 4.76 \, l$.}
  \label{fig:RD}
\end{figure}
%
In this subsection I demonstrate rectification for the frequency graded chain. I  used the method described in section \ref{sec:chapter5_steadyState} for $^{24}$Mg$^+$ ions with the same parameters for the baths used before. I fix the trapping frequency of the leftmost trap to $\omega_1 = 2\pi \times 1$ MHz, and a trap spacing $a = 4.76\, l$ ($25\,\mu$m) (the  characteristic length is $l = 5.25\,\mu$m). Figure \ref{fig:RFG} depicts  the results with these parameters in a graded chain. Figure \ref{fig:RFG} (a) shows that both
$J_\rightarrow$ and $J_\leftarrow$
% the right-going flux (dashed line) and the left-going flux (solid line)
decrease rapidly as the frequency increment  is increased.
%In fig. \ref{fig:Graded_24Mg_FluxAndRectification_VS_FreqGradient} I see that
The rectification reaches its maximum value for a frequency difference of $\Delta\omega \approx 0.1 \omega_1$. The fluxes cross so there are some points where the rectification is exactly zero, besides the trivial one at $\Delta\omega = 0$, at $\Delta\omega = 0.05\,\omega_1,\;0.3\,\omega_1,\;1.3\,\omega_1$. At these points the direction of rectification reverses, presumably as a consequence of the changes in the match/mismatch of the temperature dependent local power spectra.
The change of rectification direction occurs for all the choices of parameters, as displayed in fig. \ref{fig:Graded_24Mg_Rectification_VS_Gradient_and_lattConstant}. Figure \ref{fig:Graded_24Mg_Rectification_VS_Gradient_and_lattConstant} gives the rectification factor for different trap distances and frequency increments.  $0$-rectification curves separate regions with different rectification direction. The second region in fig. \ref{fig:Graded_24Mg_Rectification_VS_Gradient_and_lattConstant} (starting from the left) would be the most interesting one to build a thermal diode, since rectification reaches its largest values there.

{For small values of $\Delta \omega$ there is little asymmetry in the chain and therefore modest rectification is expected whereas a very large $\Delta \omega$ implies very high trapping frequencies on the right implying a too strong confinement and vanishing interactions. This bottleneck reduces the fluxes in both directions and  the rectification. However, since $\Delta \omega$ is controllable,
and the range of values of $\Delta \omega$ for which rectification is larger can be also controlled with the intertrap distance $a$, see fig. \ref{fig:Graded_24Mg_Rectification_VS_Gradient_and_lattConstant},
the existence of a rectification window
does not imply a major limitation.}

\begin{figure}
  \center
  \includegraphics[width=0.75\linewidth]{Figures/Changing_N.eps}
  \caption{Rectification factor for different bath temperature differences $\Delta T$ as the number of ions is increased. The detuning of the cold bath laser is set to the Doppler limit $\delta_C = - \Gamma / 2$. $\omega_1 = 2 \pi \times 1$ MHz, $\Delta \omega = 0.15 \, \omega_1$, $l = 5.25\,\mu$m, $a = 4.76 \, l$.}
  \label{fig:N_Dependence}
\end{figure}
%
%
\subsection{Same bath temperatures, different bath couplings\label{TC}}
%
%
As already mentioned (below eq. \eqref{eq:chapter5_Doppler}), above and below the detuning  $\delta_D=-\Gamma/2$ corresponding to the  Doppler limit temperature, the optical molasses allow for
two different couplings (two pairs of friction and diffusion coefficients in eq. (\ref{eq:chapter5_DopplerCooling})) between the ions and the laser corresponding to the same bath temperature.
This duality may be seen explicitly in fig. \ref{fig:RD}. Specifically fig. \ref{fig:RD} (a) depicts the variation of the friction coefficient for values of $\delta$ around $\delta_R$,  and fig. \ref{fig:RD} (b) the corresponding temperatures.
Interestingly, the different couplings imply different rectification factors.
% To check if this requirement is fulfilled I have calculated the rectification factor for different temperatures in the baths.
If I set $\delta_C = \delta_D=-\Gamma / 2$,  i.e., the cold bath is cooled to the Doppler limit, $\delta_H$ can be chosen to be below or above $\delta_D$ for the same temperature $T_H$. The corresponding rectification factors for the two choices
are shown in  fig. \ref{fig:RD} (c),
%I see that it is possible to achieve comparable rectifications for smaller temperature differences when $\delta_H<\delta_D$.
%Note that since the effective laser temperatures depend on the linewidth $\Gamma$ of the atomic transition, the range of temperatures that can be reached is limited to the mK. Although other works have shown rectification in temperatures of the order of 100 K \cite{Elzouka2017}, the nature of the rectification mechanism and the physical system are very different. Here I have considered an atomic system, instead of a macroscopic one, where the temperatures are intrinsically low.
which
demonstrates that significant rectification can be achieved by choosing $\delta_H<\delta_D$ for temperature increments that
are smaller than or of the order of $T_C=T_D$, for example $R\approx 20\%$ for $\Delta T=0.1 T_C$, or $R\approx 60\%$
for $\Delta T= T_C$.  Finding good rectification at low (relative) temperature differences is considered to be one on the challenges
in asymmetric heat transport research \cite{Zhang2015}.

%
%
%
\subsection{Dependence with number of ions\label{IN}}
%
Keeping in mind that scaling the frequency-graded ion chain  to a large numbers of ions is not a realistic option in this setting,
it is nevertheless important to
study the dependence with ion number from small to moderate numbers.  In fig. \ref{fig:N_Dependence} I observe an overall trend in which the rectification decreases with the number of ions in the chain (while it increases with temperature bias $\Delta T$ in the studied range). This effect is easy to understand, as increasing $N$
while keeping the total variation of the trapping frequency $\Delta \omega$ constant, the frequency gradient  decreases. This
lowers  the  asymmetry in the chain and the rectification factor. Oscillations with $N$ superimposed to the global trend are more visible for smaller $N$ giving  an optimal value at $N=19$.

\subsection{Graded versus segmented\label{GS}}
%
I have also compared the performance of the graded thermal diode and a segmented version in which the left half of the chain is trapped with frequency $\omega_1$ and the right half (including the middle ion) with $\omega_1+\Delta \omega$. Even though the optimal rectification  in fig. \ref{fig:GS} (a)  for the segmented chain is larger than for the graded chain, the fact that the fluxes are generally much larger for the graded chain, see fig. \ref{fig:GS} (b), makes the graded chain more interesting for applications.



\begin{figure}
  \center
  \includegraphics[width=0.75\linewidth]{Figures/24Mg_Comparacion_Graded_AND_Segmented.eps}
  \caption{Comparison of graded and segmented chains with $N=15$ $^{24}$Mg$^+$ ions. (a) Maximum
  of $J_\rightarrow$ and $J_\leftarrow$
   for the graded and segmented chain for different frequency increments. (b) Rectification factor: graded chain (dashed lines); segmented chain (solid lines). Parameters: $\omega_1 = 2 \pi \times 1$ MHz, $l = 5.25\,\mu$m, $a = 4.76 \, l$, $\delta_H = -0.02 \, \Gamma$, and $\delta_C = -0.1 \, \Gamma$.}
  \label{fig:GS}
\end{figure}

\section{Discussion\label{sec:chapter5_Discussion}}
%
In this chapter I have numerically demonstrated heat rectification in a chain of ions trapped in individual microtraps with graded frequencies, connected at both ends to thermal baths
created by optical molasses. An alternative to implement a graded
frequency profile in the lab
could be combining a collective Paul trap for all the ions with on-site dipolar laser forces \cite{Freitas2015,Enderlein2012,Bermudez2013,Schneider2010}.

A goal of this chapter is to connect two communities, ion trappers and
researchers on heat-rectification models. The results found are encouraging and demonstrate the potential of a trapped-ion platform to experimentally investigate heat rectification schemes. Trapped ions are quite interesting to this end because  they are highly controllable,  and may easily adopt several features to enhance rectification, such as
the ones explored here (long-range interactions and an asymmetrical gradation),
or others such as time-dependent forces \cite{Li2012,Riera-Campeny2018}, or different non-linearities in on-site forces.
The limitations and application domain should also be clear,  the proposed platform is circumscribed to cold temperatures of the order of hundreds of $\mu$K to mK achieved by Doppler cooling.
In this sense it is not aimed at competing  with (it is rather complementary to)
proposals for which experiments  \cite{Chang2006,Leitner2013,Kobayashi2009,Elzouka2017} or simulations \cite{Zhang2015,Ma2018,Reid2019}
demonstrate thermal rectification
at room temperature or for hundreds of K.
Also, the number of ions should realistically be kept small so the proposed ion chain
is not aimed at achieving a macroscopic diode length, but at playing a role in thermal diode research
and in the context of ion-trapped based quantum technologies.

Methodologically, the calculation of the steady state has been performed with an algebraic approach much faster than
the time-consuming integration and averaging over noise and time of the dynamical equations.
The algebraic approach linearizes the forces around equilibrium positions which, in this system and for the realistic parameters considered  is well justified and tested numerically.
The results found provide additional evidence that simple linear models may  rectify heat flow \cite{Pereira2017}.  I  underline that this linear
model is, arguably,  even simpler than some linear ``minimalist, toy models'' in \cite{Pereira2017} that showed rectification (the on-site forces are already linear from the start and the temperature dependence of explicit model parameters is only in the coefficients of the Langevin baths), with the important bonus of being also realistic.
